<!DOCTYPE html>
<html>
  <head>
    <script src="jquery.js"></script>
    <script src="data_generator.js"></script>
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <div class="container">
      <div class="header"><h2>Twittler</h2></div>
      <div class="main-content">
        <ul class="tweets">
        </ul>
      </div>
      <div class="footer">footer</div>
    </div>
    <script>
      $(document).ready(function(){
    var liveUpdates = true;

      var userTimeline = function(user) {
       console.log(user);
        user = user.split(' ');
        user = user[0];
        user = '.' + user;

        $('li:not(user)').slideUp();
        $(user).slideDown();

        
        $home.show();
        $('.home').on('click', function(event) {
          liveUpdates = true;
          $home.hide();
          newTweets();
        });
      }

        var $home = $('<a href="#" class="home">Home</a>');
            $home.appendTo('.header');
        var $body = $('body');
        //var $newTweetButton = $("<button id='new-tweet'>Click to check for new tweets</button>");
        //$newTweetButton.appendTo($('.header'));
        var min = 0;

        var newTweets = function() {

          var index = streams.home.length - 1;
          while(index >= min){
            var tweet = streams.home[index];
            var $tweet = $('<li class=' + tweet.user + '></li>');
            var $user = $("<a href='#' class='link'>@" + tweet.user + "</a>");
            
            $tweet.addClass(index.toString());

            var now = new Date($.now());

            $tweet.text(":" + tweet.message + " ");

            $tweet.prependTo($(".tweets"));

            $("." + index).append(now);
            $("." + index).prepend($user);
            $('li').slideDown();
            index -= 1;
          }
          min = streams.home.length;  //store this value for already displayed tweets

          $('li').on('click', '.link', function(event) {
            event.preventDefault();
            console.log('click!');
            liveUpdates = false;
            userTimeline($(this).closest('li').attr("class"));
          });
          

        }

        newTweets();  //display tweets on page load

        $('#new-tweet').on('click', newTweets);


        setInterval(function() {
          if (liveUpdates) {
            newTweets();
          }}, 3000);


        });

    </script>
  </body>
</html>
